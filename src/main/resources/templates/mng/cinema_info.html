<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>影院管理</title>
    <link rel="icon" href="favicon.ico" type="image/ico">
    <meta name="author" content="Yodo">


    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>-->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.15.1/moment.min.js"></script>-->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>-->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.7.14/js/bootstrap-datetimepicker.min.js"></script>-->

    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">-->




    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/materialdesignicons.min.css" rel="stylesheet">
    <link href="css/style.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.7.14/css/bootstrap-datetimepicker.min.css">
</head>

<body data-theme="default">

<div class="lyear-layout-web" >
    <div class="lyear-layout-container">
        <!--左侧导航-->
        <aside class="lyear-layout-sidebar">

            <!-- logo -->
            <div id="logo" class="sidebar-header">

                <a href="index_xdq_new.html"><img src="images/Cinema_logo_small_new.png" title="LightYear" alt="LightYear" /></a>
            </div>
            <div class="lyear-layout-sidebar-scroll">

                <nav class="sidebar-main">
                    <ul class="nav nav-drawer">
                        <li class="nav-item active"> <a href="index_xdq_new.html"><i class="mdi mdi-home"></i> 影院管理首页</a> </li>
                        <li class="nav-item"> <a href="xdq_cinema_arrangements.html"><i class="mdi mdi-table"></i> 影院排片管理</a> </li>
                        <li class="nav-item"> <a href="xdq_cinema_rooms.html"><i class="mdi mdi-home-circle"></i> 影院影厅管理</a> </li>
                        <li class="nav-item"> <a href="xdq_cinema_comments.html"><i class="mdi mdi-comment"></i> 影院评论管理</a> </li>
                    </ul>
                </nav>




            </div>

        </aside>
        <!--End 左侧导航-->

        <!--头部信息-->
        <header class="lyear-layout-header">

            <nav class="navbar navbar-default">
                <div class="topbar">

                    <div class="topbar-left">
                        <div class="lyear-aside-toggler">
                            <span class="lyear-toggler-bar"></span>
                            <span class="lyear-toggler-bar"></span>
                            <span class="lyear-toggler-bar"></span>
                        </div>
                        <span class="navbar-page-title"> 管理影院信息 </span>
                    </div>

                    <ul class="topbar-right">
                        <li class="dropdown dropdown-profile">
                            <a href="javascript:void(0)" data-toggle="dropdown">
                                <img id="image1" class="img-avatar img-avatar-48 m-r-10" src="images/users/xdq.jpg" alt="徐德全" />
                                <span id="username1">徐德全 <span class="caret"></span></span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-right">
                                <li> <a href="cinema_info.html"><i class="mdi mdi-account"></i> 个人信息</a> </li>
                                <li> <a href="lyear_pages_edit_pwd.html"><i class="mdi mdi-lock-outline"></i> 修改密码</a> </li>
                                <li> <a href="javascript:void(0)"><i class="mdi mdi-delete"></i> 清空缓存</a></li>
                                <li class="divider"></li>
                                <li> <a href="xdq_cinema_login.html"><i class="mdi mdi-logout-variant"></i> 退出登录</a> </li>
                            </ul>
                        </li>
                        <!--切换主题配色-->
                        <li class="dropdown dropdown-skin">
                            <span data-toggle="dropdown" class="icon-palette"><i class="mdi mdi-palette"></i></span>
                            <ul class="dropdown-menu dropdown-menu-right" data-stopPropagation="true">
                                <li class="drop-title"><p>主题</p></li>
                                <li class="drop-skin-li clearfix">
                  <span>
                    <input type="radio" name="site_theme" value="default" id="site_theme_1" checked>
                    <label for="site_theme_1"></label>
                  </span>
                                    <span class="inverse">
                    <input type="radio" name="site_theme" value="dark" id="site_theme_2" checked>
                    <label for="site_theme_2"></label>
                  </span>
                                    <span>
                    <input type="radio" name="site_theme" value="translucent" id="site_theme_3">
                    <label for="site_theme_3"></label>
                  </span>
                                </li>
                                <li class="drop-title"><p>LOGO</p></li>
                                <li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="logo_bg" value="default" id="logo_bg_1" checked>
                    <label for="logo_bg_1"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_2" id="logo_bg_2">
                    <label for="logo_bg_2"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_3" id="logo_bg_3">
                    <label for="logo_bg_3"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_4" id="logo_bg_4">
                    <label for="logo_bg_4"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_5" id="logo_bg_5">
                    <label for="logo_bg_5"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_6" id="logo_bg_6">
                    <label for="logo_bg_6"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_7" id="logo_bg_7">
                    <label for="logo_bg_7"></label>
                  </span>
                                    <span>
                    <input type="radio" name="logo_bg" value="color_8" id="logo_bg_8">
                    <label for="logo_bg_8"></label>
                  </span>
                                </li>
                                <li class="drop-title"><p>头部</p></li>
                                <li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="header_bg" value="default" id="header_bg_1" checked>
                    <label for="header_bg_1"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_2" id="header_bg_2">
                    <label for="header_bg_2"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_3" id="header_bg_3">
                    <label for="header_bg_3"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_4" id="header_bg_4">
                    <label for="header_bg_4"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_5" id="header_bg_5">
                    <label for="header_bg_5"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_6" id="header_bg_6">
                    <label for="header_bg_6"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_7" id="header_bg_7">
                    <label for="header_bg_7"></label>
                  </span>
                                    <span>
                    <input type="radio" name="header_bg" value="color_8" id="header_bg_8">
                    <label for="header_bg_8"></label>
                  </span>
                                </li>
                                <li class="drop-title"><p>侧边栏</p></li>
                                <li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="sidebar_bg" value="default" id="sidebar_bg_1" checked>
                    <label for="sidebar_bg_1"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_2" id="sidebar_bg_2">
                    <label for="sidebar_bg_2"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_3" id="sidebar_bg_3">
                    <label for="sidebar_bg_3"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_4" id="sidebar_bg_4">
                    <label for="sidebar_bg_4"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_5" id="sidebar_bg_5">
                    <label for="sidebar_bg_5"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_6" id="sidebar_bg_6">
                    <label for="sidebar_bg_6"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_7" id="sidebar_bg_7">
                    <label for="sidebar_bg_7"></label>
                  </span>
                                    <span>
                    <input type="radio" name="sidebar_bg" value="color_8" id="sidebar_bg_8">
                    <label for="sidebar_bg_8"></label>
                  </span>
                                </li>
                            </ul>
                        </li>
                        <!--切换主题配色-->
                    </ul>

                </div>
            </nav>

        </header>
        <!--End 头部信息-->

        <!--页面主要内容-->

        <main class="lyear-layout-content">

            <div class="container-fluid" id="app1">

                <div class="row">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-body">

                                <div class="edit-avatar">
                                    <!--<img id="image" src="images/users/avatar.jpg" alt="..." class="img-avatar">-->
                                    <img id="image2" src="" alt="..." class="img-avatar">
                                    <div class="avatar-divider"></div>
                                    <div class="edit-avatar-content">
                                        <!--<button class="btn btn-default" >修改头像</button>-->
                                        <label for="username2">用户名</label><span style="color:blue;" onclick="getCookie_username()">(点击取消隐藏)</span>
                                        <!--<p class="m-0">选择一张你喜欢的图片，裁剪后会自动生成264x264大小，上传图片大小不能超过2M。</p>-->
                                    </div>
                                </div>
                                <hr>
                                <form method="post" action="#!" class="site-form">
                                    <div class="form-group">


                                        <input class="form-control" name="username" id="username2" value="******" disabled="disabled" />
                                    </div>
                                    <div class="form-group">
                                        <label>用户类型</label>
                                        <input class="form-control" name="type" value="影院管理员" disabled="disabled" />
                                        <!--<input v-model="" type="text" class="form-control" name="old_password" id="old_password" placeholder="输入旧密码" value="">-->
                                        <!--<small id="emailHelp" class="form-text text-muted">请保证您填写的旧密码是正确的。否则会修改失败。</small>-->
                                    </div>
                                    <div class="form-group">
                                        <label>管理员序号</label>
                                        <input class="form-control" name="username" id="number" value="******" disabled="disabled" />
                                        <!--<input type="text" class="form-control" name="new_password" id="new_password"  placeholder="输入新密码" value="">-->

                                    </div>
                                    <!--<div class="form-group">-->
                                        <!--<label for="remark">简介</label>-->
                                        <!--<textarea class="form-control" name="remark" id="remark" rows="3"></textarea>-->
                                    <!--</div>-->
                                    <!--<button type="submit" class="btn btn-primary">保存</button>-->
                                </form>
                                    <button v-on:click="modeSwitch()">切换查看/修改模式</button>
                                    <div v-if="this.mode == false">
                                    <div class="form-group">
                                        <label>所属影院名称</label>
                                        <input v-model="cinemaName" class="form-control" name="type" value=""/>
                                    </div>
                                    <div class="form-group">
                                        <label>影院简介</label>
                                        <input v-model="cinemaDescription" class="form-control" name="type" value=""/>
                                    </div>
                                    <div class="form-group">
                                        <label>影院照片</label>
                                        <input id="hall_img_input" type="file" class="form-control" />
                                    </div>
                                    <!--<div class="form-group">-->
                                    <!--<label for="remark">简介</label>-->
                                    <!--<textarea class="form-control" name="remark" id="remark" rows="3"></textarea>-->
                                    <!--</div>-->
                                    <button v-on:click="updateCinema()" class="btn btn-primary">保存</button>
                                    </div>

                                <div v-if="this.mode == true">
                                    <div class="form-group">
                                        <label>所属影院名称</label>
                                        <!--<input v-model="cinemaName_view" class="form-control" name="type" value=""/>-->
                                        <p>{{ this.cinemaName_view }}</p>
                                    </div>
                                    <div class="form-group">
                                        <label>影院简介</label>
                                        <!--<input v-model="cinemaDescription_view" class="form-control" name="type" value=""/>-->
                                        <p>{{ this.cinemaDescription_view }}</p>
                                    </div>
                                    <div>
                                        <label>影院照片</label>
                                        <img v-bind:src="cinemaImage_view" type="file" class="form-control">
                                    </div>
                                    <!--<div class="form-group">-->
                                    <!--<label for="remark">简介</label>-->
                                    <!--<textarea class="form-control" name="remark" id="remark" rows="3"></textarea>-->
                                    <!--</div>-->
                                    <!--<button v-on:click="updateCinema()" class="btn btn-primary">保存</button>-->
                                </div>

                            </div>
                        </div>
                    </div>

                </div>

            </div>

        </main>
        <!--End 页面主要内容-->
    </div>
</div>


<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.15.1/moment.min.js"></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>-->

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.7.14/js/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript" src="js/perfect-scrollbar.min.js"></script>
<script type="text/javascript" src="js/main.min.js"></script>

<script src="js/vue.js"></script>
<script src="js/axios.js"></script>

<script type = "text/javascript">
    document.getElementById('image1').src = getCookie("image");
    document.getElementById('image2').src = getCookie("image");
    document.getElementById('username1').innerHTML = getCookie("name");
    document.getElementById('number').value = getCookie("id");
    // document.getElementById('username2').value = getCookie("name");
    console.log("这是image"+document.getElementById('image').src);

    function getCookie_username(){
        document.getElementById('username2').value = getCookie("name");
        // console.log("这是cookie"+document.cookie);
        console.log("这是userId"+document.getElementById('username').value);
    }

    function getCookie_image(){
        document.getElementById('username').src = getCookie("image");
        // console.log("这是cookie"+document.cookie);
        console.log("这是userId"+document.getElementById('username').value);
    }

    function getCookie(cookie_name) {
        var allcookies = document.cookie;
        //索引长度，开始索引的位置
        var cookie_pos = allcookies.indexOf(cookie_name);
        // 如果找到了索引，就代表cookie存在,否则不存在
        if (cookie_pos != -1) {
            // 把cookie_pos放在值的开始，只要给值加1即可
            //计算取cookie值得开始索引，加的1为“=”
            cookie_pos = cookie_pos + cookie_name.length + 1;
            //计算取cookie值得结束索引
            var cookie_end = allcookies.indexOf(";", cookie_pos);
            if (cookie_end == -1) {
                cookie_end = allcookies.length;
            }
            //得到想要的cookie的值
            var value = unescape(allcookies.substring(cookie_pos, cookie_end));
        }
        return value;
    }


</script>

<script type = "text/javascript">
    new Vue({
        el: '#app1',
        data () {
            return {
                info: null,
                refresh_info:null,
                username:null,
                cinemaName:null,
                cinemaDescription:null,

                cinemaName_view:null,
                cinemaDescription_view:null,
                cinemaImage_view:null,
                //规范命名
                mode:null,

            }
        },
        methods:{
            modeSwitch(){

                this.mode = !(this.mode);
                if(this.mode == true){
                    this.refreshCinema();
                };
            },
            refreshCinema(){

                axios.get('http://localhost:8081/cinema/get'+'?id='+'1')
                    .then(response => {
                        this.refresh_info = response.data.data;
                        console.log("这是refresh_info"+this.refresh_info);
                    })

                this.cinemaName_view = this.refresh_info.cinema_info.cinemaName;
                this.cinemaDescription_view = this.refresh_info.cinema_info.cinemaDescription;
                this.cinemaImage_view = this.refresh_info.cinema_info.figureList[0].imageurl;
                console.log("这是refresh三个变量"+this.cinemaName_view+this.cinemaDescription_view+this.cinemaImage_view);

                //get方法
            },
            updateCinema(){
                let param = new FormData()
                var file = document.getElementById("hall_img_input").files
                for(let i = 0;i<file.length;i++){
                    param.append("figureList",file[i])
                }
                // 1改成this.cinemaId
                param.append("cinemaId",1)
                param.append("cinemaDescription",this.cinemaDescription)
                param.append("cinemaName",this.cinemaName)
                let config = {
                    //添加请求头
                    headers: { "Content-Type": "multipart/form-data" },
                    //添加上传进度监听事件
                    onUploadProgress: e => {
                        var completeProgress = ((e.loaded / e.total * 100) | 0) + "%";
                        this.progress = completeProgress;
                    }
                };
                //param,config
                axios.put("http://localhost:8081/cinema/update",param,config)
                    .then(response => {
                        console.log(response);
                        console.log("成功了吗？"+this.cinemaDescription);
                        // alert("添加成功！");
                        // window.location.href = "http://localhost:8081/mng/xdq_cinema_rooms.html";
                    })
                     .catch(function (error) { // 请求失败处理
                    console.log(error);
                });


            }
        },
        mounted () {
            axios
                .get('http://localhost:8081/statistics/getBuyStatisByDate?cienma_id=1&end_date=2021%2F11%2F01%2010%3A00%3A00&start_date=2019%2F01%2F01%2010%3A00%3A00')
                .then(response => {
                    this.info = response.data.data;
                    console.log("这是vue里的log"+this.info);
                })
            this.refreshCinema();
        }
    })
</script>





</body>
</html>
